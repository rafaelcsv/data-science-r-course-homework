{
  "hash": "75e889ce47437df9e6798ed087f4e572",
  "result": {
    "markdown": "---\ntitle: \"Sleep Apnea\"\nsubtitle: \"A Case Series\"\nauthor: \"R. Vasconcelos\"\ndate: today\ndate-format: long\nformat:\n  html:\n    smooth-scroll: true\n    self-contained: true\n    toc: true\n    toc-location: left\ntheme: cosmo\nsmooth-scroll: true\nproject:\n  output-dir: outputs/documents\n---\n\n\n# Setup\n\n## Housekeeping\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# This ensures we have the default settings for all the R chunks.\n\nknitr::opts_chunk$set(\n  collapse    = TRUE,\n  warning     = FALSE, # Whether to display warnings\n  message     = FALSE, # Whether to display messages\n  echo        = TRUE,  # In this case we want to see the code \n  eval        = TRUE   # Whether to evaluate the code and include its results\n  )\n\n# Clearing all objects, including hidden objects.\n\nrm(list = ls(all.names = TRUE))\n\n# Setting a seed is important every time R needs to do random calculations, ensuring the results remain constant.\n\nset.seed(123)\n```\n:::\n\n\n## Install and load libraries\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Every time you run a new session, libraries must be loaded.\n\n# Package list\nrequired_packages <- c(\n                       \"tidyverse\",   \n                       \"dplyr\",\n                       \"broom\",\n                       \"ggplot2\",\n                       \"readxl\",\n                       \"kableExtra\",\n                       \"patchwork\",\n                       \"table1\",\n                       \"skimr\"\n                       )      \n \nfor (pkg in required_packages) {\n\n  # Install packages if not already present\n  if (!pkg %in% rownames(installed.packages())) {\n    install.packages(pkg)\n  }\n  \n  # Load packages to this current session \n  library(pkg, character.only = TRUE)\n}\n```\n:::\n\n\n## Load data and clean names\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# First, lets load the dataset - in this case, an Excel file.\nhypoxia <- read_excel(\"datasets/hypoxia.xlsx\")\n\n# Second, we'll clean the variable names, getting rid of capitals and spaces.\nhypoxia <- janitor::clean_names(hypoxia) \n\n# Third, we'll extract the variables we need and save them to a new smaller dataset.\nhypoxia_lite <- hypoxia %>%\n  select(age,\n         female,\n         race,\n         bmi,\n         sleeptime,\n         min_sao2,\n         ahi,\n         smoking,\n         diabetes,\n         hyper,\n         cad,\n         cpap,\n         type_surg,\n         duration_of_surg\n         )\n\n# Lastly, we'll assing the labels to categorical variable.\nhypoxia_lite <- hypoxia_lite %>%\n  mutate(\n    type_surg = case_when(\n      type_surg == 1 ~ \"Gastroenterostomy\",\n      type_surg == 2 ~ \"Gastric restrictive procedure\",\n      type_surg == 3 ~ \"Gastroplasty\",\n      type_surg == 4 ~ \"Removal of gastric restrictive device\"),\n    race = case_when(\n      race == 1 ~ \"African American\",\n      race == 2 ~ \"Caucasian\",\n      race == 3 ~ \"Other\"\n      )\n  )\n\n```\n:::\n\n\n\\newpage\n\n# Image\n\n![Image 1 - Hospital. Photo by Silas Camargo Sil√£o from Pixabay](images/hospital-gf6a9be5ea_1280.jpg){fig-alt=\"photo of hospital beds\" fig-align=\"center\"}\n\n\\newpage\n\n# Equation\n\n\n$$ BMI = \\frac {Weight} {Height^2} $$\n\n\n\\newpage\n\n# Inline\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# We'll create a summary dataset, grouped by surgery type.\nsum_hypoxia <- hypoxia_lite %>% # new table with summary statistics\n  group_by(type_surg) %>% # group results by surgery type\n  summarise(n_surgeries=dplyr::n(), # number of surgeries\n            mean_age=mean(age, na.rm = TRUE), # mean patient age\n            percent_female=mean(female, na.rm = TRUE), # female patient percentage\n            mean_bmi=mean(bmi, na.rm = TRUE), # mean patient BMI\n            mean_sleeptime=mean(sleeptime, na.rm = TRUE), # mean sleep time with SaO2 < 90%\n            percent_smoking=mean(smoking, na.rm = TRUE), # percentage of patients who smoke\n            percent_diabetes=mean(diabetes, na.rm = TRUE), # percentage of diabetic patients\n            percent_hyper=mean(hyper, na.rm = TRUE), # percentage of patients with hypertension\n            mean_duration=mean(duration_of_surg, na.rm = TRUE), # mean surgery time\n  )\n\n# This creates variables with the n() of each surgery type via a for() loop.\nlist_types <- c(\"Gastroenterostomy\",\"Gastric restrictive procedure\",\"Gastroplasty\",\"Removal of gastric restrictive device\")\n\nvar_names <- paste0(\"a\", 1:4)\n\nfor (i in seq_along(var_names)){\n  assign(var_names[[i]], sum_hypoxia %>%\n           filter(type_surg==list_types[[i]]) %>%\n           pull(n_surgeries))\n}\n\n# We'll be able to call those variables inline with `r a1`, `r a2`, and so forth.\n```\n:::\n\n\nDuring the study period, 225 gastroenterostomies, 51 gastric restrictive procedures, 3 gastroplasties, and 2 removals of gastric restrictive devices were performed.\n\n\\newpage\n\n# Tables\n\n## Table 1\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# This creates a table 1, useful for scientific articles.\nt1 <- table1(~ age +\n         factor(female) + \n         factor(race) +\n         factor(diabetes) |\n         type_surg,\n       data=hypoxia_lite,\n       footnote = \"Source: TSHS datasets\",\n       caption = \"Descriptive variables by type of surgery\"\n       )\n\nt1\n```\n\n::: {.cell-output-display}\n```{=html}\n<div class=\"Rtable1\"><table class=\"Rtable1\"><caption>Descriptive variables by type of surgery</caption>\n\n<thead>\n<tr>\n<th class='rowlabel firstrow lastrow'></th>\n<th class='firstrow lastrow'><span class='stratlabel'>Gastric restrictive procedure<br><span class='stratn'>(N=51)</span></span></th>\n<th class='firstrow lastrow'><span class='stratlabel'>Gastroenterostomy<br><span class='stratn'>(N=225)</span></span></th>\n<th class='firstrow lastrow'><span class='stratlabel'>Gastroplasty<br><span class='stratn'>(N=3)</span></span></th>\n<th class='firstrow lastrow'><span class='stratlabel'>Removal of gastric restrictive device<br><span class='stratn'>(N=2)</span></span></th>\n<th class='firstrow lastrow'><span class='stratlabel'>Overall<br><span class='stratn'>(N=281)</span></span></th>\n</tr>\n<tfoot><tr><td colspan=\"6\" class=\"Rtable1-footnote\"><p>Source: TSHS datasets</p>\n</td></tr></tfoot>\n</thead>\n<tbody>\n<tr>\n<td class='rowlabel firstrow'>age</td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n</tr>\n<tr>\n<td class='rowlabel'>Mean (SD)</td>\n<td>49.8 (13.8)</td>\n<td>46.9 (10.3)</td>\n<td>33.0 (4.37)</td>\n<td>51.9 (9.83)</td>\n<td>47.3 (11.1)</td>\n</tr>\n<tr>\n<td class='rowlabel lastrow'>Median [Min, Max]</td>\n<td class='lastrow'>51.3 [17.9, 72.9]</td>\n<td class='lastrow'>47.8 [16.4, 73.8]</td>\n<td class='lastrow'>32.6 [28.9, 37.6]</td>\n<td class='lastrow'>51.9 [44.9, 58.8]</td>\n<td class='lastrow'>48.2 [16.4, 73.8]</td>\n</tr>\n<tr>\n<td class='rowlabel firstrow'>factor(female)</td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n</tr>\n<tr>\n<td class='rowlabel'>0</td>\n<td>19 (37.3%)</td>\n<td>60 (26.7%)</td>\n<td>1 (33.3%)</td>\n<td>0 (0%)</td>\n<td>80 (28.5%)</td>\n</tr>\n<tr>\n<td class='rowlabel lastrow'>1</td>\n<td class='lastrow'>32 (62.7%)</td>\n<td class='lastrow'>165 (73.3%)</td>\n<td class='lastrow'>2 (66.7%)</td>\n<td class='lastrow'>2 (100%)</td>\n<td class='lastrow'>201 (71.5%)</td>\n</tr>\n<tr>\n<td class='rowlabel firstrow'>factor(race)</td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n</tr>\n<tr>\n<td class='rowlabel'>African American</td>\n<td>12 (23.5%)</td>\n<td>43 (19.1%)</td>\n<td>2 (66.7%)</td>\n<td>0 (0%)</td>\n<td>57 (20.3%)</td>\n</tr>\n<tr>\n<td class='rowlabel'>Caucasian</td>\n<td>38 (74.5%)</td>\n<td>176 (78.2%)</td>\n<td>1 (33.3%)</td>\n<td>1 (50.0%)</td>\n<td>216 (76.9%)</td>\n</tr>\n<tr>\n<td class='rowlabel lastrow'>Other</td>\n<td class='lastrow'>1 (2.0%)</td>\n<td class='lastrow'>6 (2.7%)</td>\n<td class='lastrow'>0 (0%)</td>\n<td class='lastrow'>1 (50.0%)</td>\n<td class='lastrow'>8 (2.8%)</td>\n</tr>\n<tr>\n<td class='rowlabel firstrow'>factor(diabetes)</td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n</tr>\n<tr>\n<td class='rowlabel'>0</td>\n<td>35 (68.6%)</td>\n<td>145 (64.4%)</td>\n<td>3 (100%)</td>\n<td>1 (50.0%)</td>\n<td>184 (65.5%)</td>\n</tr>\n<tr>\n<td class='rowlabel lastrow'>1</td>\n<td class='lastrow'>16 (31.4%)</td>\n<td class='lastrow'>80 (35.6%)</td>\n<td class='lastrow'>0 (0%)</td>\n<td class='lastrow'>1 (50.0%)</td>\n<td class='lastrow'>97 (34.5%)</td>\n</tr>\n</tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n## Skim\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# For a deeper look, we can use the skim() function from the \"skimr\" package.\nt2 <- skim(select(hypoxia_lite, -race, -type_surg)) %>%\n  kbl(digits = 3,\n      caption = \"Data summary\") %>%\n  kable_classic(html_font = \"Calibri\") %>%\n  footnote(\n    general_title = \"\",\n    general = \"Source: TSHS datasets\"\n    ) \n\nt2\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\" lightable-classic\" style=\"font-family: Calibri; margin-left: auto; margin-right: auto;border-bottom: 0;\">\n<caption>Data summary</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> skim_type </th>\n   <th style=\"text-align:left;\"> skim_variable </th>\n   <th style=\"text-align:right;\"> n_missing </th>\n   <th style=\"text-align:right;\"> complete_rate </th>\n   <th style=\"text-align:right;\"> numeric.mean </th>\n   <th style=\"text-align:right;\"> numeric.sd </th>\n   <th style=\"text-align:right;\"> numeric.p0 </th>\n   <th style=\"text-align:right;\"> numeric.p25 </th>\n   <th style=\"text-align:right;\"> numeric.p50 </th>\n   <th style=\"text-align:right;\"> numeric.p75 </th>\n   <th style=\"text-align:right;\"> numeric.p100 </th>\n   <th style=\"text-align:left;\"> numeric.hist </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> numeric </td>\n   <td style=\"text-align:left;\"> age </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 1.000 </td>\n   <td style=\"text-align:right;\"> 47.293 </td>\n   <td style=\"text-align:right;\"> 11.117 </td>\n   <td style=\"text-align:right;\"> 16.4 </td>\n   <td style=\"text-align:right;\"> 39.6 </td>\n   <td style=\"text-align:right;\"> 48.2 </td>\n   <td style=\"text-align:right;\"> 54.7 </td>\n   <td style=\"text-align:right;\"> 73.8 </td>\n   <td style=\"text-align:left;\"> ‚ñÅ‚ñÖ‚ñá‚ñá‚ñÇ </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> numeric </td>\n   <td style=\"text-align:left;\"> female </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 1.000 </td>\n   <td style=\"text-align:right;\"> 0.715 </td>\n   <td style=\"text-align:right;\"> 0.452 </td>\n   <td style=\"text-align:right;\"> 0.0 </td>\n   <td style=\"text-align:right;\"> 0.0 </td>\n   <td style=\"text-align:right;\"> 1.0 </td>\n   <td style=\"text-align:right;\"> 1.0 </td>\n   <td style=\"text-align:right;\"> 1.0 </td>\n   <td style=\"text-align:left;\"> ‚ñÉ‚ñÅ‚ñÅ‚ñÅ‚ñá </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> numeric </td>\n   <td style=\"text-align:left;\"> bmi </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 1.000 </td>\n   <td style=\"text-align:right;\"> 46.749 </td>\n   <td style=\"text-align:right;\"> 7.774 </td>\n   <td style=\"text-align:right;\"> 23.4 </td>\n   <td style=\"text-align:right;\"> 41.5 </td>\n   <td style=\"text-align:right;\"> 46.0 </td>\n   <td style=\"text-align:right;\"> 51.7 </td>\n   <td style=\"text-align:right;\"> 71.7 </td>\n   <td style=\"text-align:left;\"> ‚ñÅ‚ñÜ‚ñá‚ñÉ‚ñÅ </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> numeric </td>\n   <td style=\"text-align:left;\"> sleeptime </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 1.000 </td>\n   <td style=\"text-align:right;\"> 18.705 </td>\n   <td style=\"text-align:right;\"> 23.727 </td>\n   <td style=\"text-align:right;\"> 0.0 </td>\n   <td style=\"text-align:right;\"> 1.4 </td>\n   <td style=\"text-align:right;\"> 8.1 </td>\n   <td style=\"text-align:right;\"> 26.9 </td>\n   <td style=\"text-align:right;\"> 99.6 </td>\n   <td style=\"text-align:left;\"> ‚ñá‚ñÇ‚ñÅ‚ñÅ‚ñÅ </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> numeric </td>\n   <td style=\"text-align:left;\"> min_sao2 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 1.000 </td>\n   <td style=\"text-align:right;\"> 78.715 </td>\n   <td style=\"text-align:right;\"> 10.618 </td>\n   <td style=\"text-align:right;\"> 28.0 </td>\n   <td style=\"text-align:right;\"> 74.0 </td>\n   <td style=\"text-align:right;\"> 82.0 </td>\n   <td style=\"text-align:right;\"> 86.0 </td>\n   <td style=\"text-align:right;\"> 95.0 </td>\n   <td style=\"text-align:left;\"> ‚ñÅ‚ñÅ‚ñÇ‚ñÖ‚ñá </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> numeric </td>\n   <td style=\"text-align:left;\"> ahi </td>\n   <td style=\"text-align:right;\"> 3 </td>\n   <td style=\"text-align:right;\"> 0.989 </td>\n   <td style=\"text-align:right;\"> 2.871 </td>\n   <td style=\"text-align:right;\"> 1.080 </td>\n   <td style=\"text-align:right;\"> 1.0 </td>\n   <td style=\"text-align:right;\"> 2.0 </td>\n   <td style=\"text-align:right;\"> 3.0 </td>\n   <td style=\"text-align:right;\"> 4.0 </td>\n   <td style=\"text-align:right;\"> 4.0 </td>\n   <td style=\"text-align:left;\"> ‚ñÉ‚ñÖ‚ñÅ‚ñÖ‚ñá </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> numeric </td>\n   <td style=\"text-align:left;\"> smoking </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 1.000 </td>\n   <td style=\"text-align:right;\"> 0.502 </td>\n   <td style=\"text-align:right;\"> 0.501 </td>\n   <td style=\"text-align:right;\"> 0.0 </td>\n   <td style=\"text-align:right;\"> 0.0 </td>\n   <td style=\"text-align:right;\"> 1.0 </td>\n   <td style=\"text-align:right;\"> 1.0 </td>\n   <td style=\"text-align:right;\"> 1.0 </td>\n   <td style=\"text-align:left;\"> ‚ñá‚ñÅ‚ñÅ‚ñÅ‚ñá </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> numeric </td>\n   <td style=\"text-align:left;\"> diabetes </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 1.000 </td>\n   <td style=\"text-align:right;\"> 0.345 </td>\n   <td style=\"text-align:right;\"> 0.476 </td>\n   <td style=\"text-align:right;\"> 0.0 </td>\n   <td style=\"text-align:right;\"> 0.0 </td>\n   <td style=\"text-align:right;\"> 0.0 </td>\n   <td style=\"text-align:right;\"> 1.0 </td>\n   <td style=\"text-align:right;\"> 1.0 </td>\n   <td style=\"text-align:left;\"> ‚ñá‚ñÅ‚ñÅ‚ñÅ‚ñÖ </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> numeric </td>\n   <td style=\"text-align:left;\"> hyper </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 1.000 </td>\n   <td style=\"text-align:right;\"> 0.708 </td>\n   <td style=\"text-align:right;\"> 0.455 </td>\n   <td style=\"text-align:right;\"> 0.0 </td>\n   <td style=\"text-align:right;\"> 0.0 </td>\n   <td style=\"text-align:right;\"> 1.0 </td>\n   <td style=\"text-align:right;\"> 1.0 </td>\n   <td style=\"text-align:right;\"> 1.0 </td>\n   <td style=\"text-align:left;\"> ‚ñÉ‚ñÅ‚ñÅ‚ñÅ‚ñá </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> numeric </td>\n   <td style=\"text-align:left;\"> cad </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 1.000 </td>\n   <td style=\"text-align:right;\"> 0.093 </td>\n   <td style=\"text-align:right;\"> 0.290 </td>\n   <td style=\"text-align:right;\"> 0.0 </td>\n   <td style=\"text-align:right;\"> 0.0 </td>\n   <td style=\"text-align:right;\"> 0.0 </td>\n   <td style=\"text-align:right;\"> 0.0 </td>\n   <td style=\"text-align:right;\"> 1.0 </td>\n   <td style=\"text-align:left;\"> ‚ñá‚ñÅ‚ñÅ‚ñÅ‚ñÅ </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> numeric </td>\n   <td style=\"text-align:left;\"> cpap </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 1.000 </td>\n   <td style=\"text-align:right;\"> 0.633 </td>\n   <td style=\"text-align:right;\"> 0.483 </td>\n   <td style=\"text-align:right;\"> 0.0 </td>\n   <td style=\"text-align:right;\"> 0.0 </td>\n   <td style=\"text-align:right;\"> 1.0 </td>\n   <td style=\"text-align:right;\"> 1.0 </td>\n   <td style=\"text-align:right;\"> 1.0 </td>\n   <td style=\"text-align:left;\"> ‚ñÖ‚ñÅ‚ñÅ‚ñÅ‚ñá </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> numeric </td>\n   <td style=\"text-align:left;\"> duration_of_surg </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 1.000 </td>\n   <td style=\"text-align:right;\"> 4.315 </td>\n   <td style=\"text-align:right;\"> 1.116 </td>\n   <td style=\"text-align:right;\"> 2.0 </td>\n   <td style=\"text-align:right;\"> 3.7 </td>\n   <td style=\"text-align:right;\"> 4.2 </td>\n   <td style=\"text-align:right;\"> 4.9 </td>\n   <td style=\"text-align:right;\"> 7.9 </td>\n   <td style=\"text-align:left;\"> ‚ñÇ‚ñá‚ñÜ‚ñÇ‚ñÅ </td>\n  </tr>\n</tbody>\n<tfoot><tr><td style=\"padding: 0; \" colspan=\"100%\">\n<sup></sup> Source: TSHS datasets</td></tr></tfoot>\n</table>\n\n`````\n:::\n:::\n\n\n\\newpage\n\n# Graphs\n\n## Density plot\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# A density plot of duration of surgery by surgery type\np1 <- ggplot(data=hypoxia_lite, \n       aes(x=duration_of_surg,\n           colour=type_surg)) +\n  geom_density() +\n  labs(title = \"Duration of surgeries by surgery type\",\n       y = \"Density\",\n       x = \"Duration of surgery (h)\",\n       caption = \"Source: TSHS datasets\",\n       color = \"Type of Surgery\") +\n  xlim(0,10) +\n  theme_minimal()\n\np1\n```\n\n::: {.cell-output-display}\n![](hipoxia_files/figure-html/plot 1-1.png){width=672}\n:::\n:::\n\n\n## Boxplot\n\n\n::: {.cell}\n\n```{.r .cell-code}\np2 <- ggplot() +\n  geom_boxplot(data = hypoxia_lite,\n               aes(x = type_surg,\n                   y = bmi),\n               colour = \"black\") +\n  geom_hline(yintercept = 40, \n             colour = \"red\") + \n  # geom_rect(aes(xmin = 0,\n  #               ymin= 40,\n  #               xmax= 5,\n  #               ymax = Inf),\n  #           fill = \"red\",\n  #           alpha = 0.5) +\n  annotate(\"text\",\n           x = 2.5,\n           y = 41,\n           label = \"Morbidly obese\",\n           size = 2,\n           colour = \"red\") +\n  labs(title = \"Body mass index of patients in each type of surgery\",\n         y = \"Body mass index\",\n         x = \"Type of surgery\", \n         caption = \"Source: TSHS datasets\") +\n  theme_minimal()\n\n p2\n```\n\n::: {.cell-output-display}\n![](hipoxia_files/figure-html/plot 2-1.png){width=672}\n:::\n:::\n\n\n## Jitter plot\n\n\n::: {.cell}\n\n```{.r .cell-code}\np3 <- ggplot(hypoxia_lite, \n       aes(x=age, \n           y=min_sao2, \n           colour=as.factor(smoking))\n       )+ \n  geom_point(alpha=0.5\n             ) +\n  geom_smooth(method = lm,\n              se= FALSE\n             ) +\n  scale_colour_discrete(labels=c('Non smokers', 'Smokers')) +\n  labs(title = expression(Age~and~Minimum~Nocturnal~SaO[2]),\n       subtitle = \"By Smoking Status\",\n       y = expression(Minimum~Nocturnal~SaO[2]),\n       x = \"Age\", \n       caption = \"Source: TSHS datasets\",\n       colour=\"\") +\n  theme_minimal() +\n  theme(legend.position=\"bottom\")\n\np3\n```\n\n::: {.cell-output-display}\n![](hipoxia_files/figure-html/plot 3-1.png){width=672}\n:::\n:::\n\n\n# Regression model\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmodel1 <- lm(bmi ~ as.factor(type_surg) + age + as.factor(female), \n             data= hypoxia_lite)\n\nmodel1_tidy <- tidy(model1, conf.int = TRUE) %>%\n  select(term, estimate, p.value, conf.low, conf.high) %>%\n  mutate(\n    term = case_when(\n      term ==\"(Intercept)\" ~ \"Intercept\",\n      term ==\"age\" ~ \"Age\",\n      term ==\"as.factor(female)1\" ~ \"Female\",\n      term ==\"as.factor(type_surg)Gastroenterostomy\" ~ \"Gastroenterostomy\",\n      term ==\"as.factor(type_surg)Gastroplasty\" ~ \"Gastroplasty\",\n      term ==\"as.factor(type_surg)Removal of gastric restrictive device\" ~ \"Removal of gastric restrictive device\")\n  )\n\nt3 <- model1_tidy %>%\n  kbl(digits = 3,\n      caption = \"Linear model\") %>%\n  kable_classic(full_width = F, \n                html_font = \"Calibri\") %>%\n  footnote(\n    general_title = \"\",\n    general = \"Source: TSHS datasets\"\n    ) \n\nt3\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\" lightable-classic\" style=\"font-family: Calibri; width: auto !important; margin-left: auto; margin-right: auto;border-bottom: 0;\">\n<caption>Linear model</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> term </th>\n   <th style=\"text-align:right;\"> estimate </th>\n   <th style=\"text-align:right;\"> p.value </th>\n   <th style=\"text-align:right;\"> conf.low </th>\n   <th style=\"text-align:right;\"> conf.high </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> Intercept </td>\n   <td style=\"text-align:right;\"> 52.420 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 47.597 </td>\n   <td style=\"text-align:right;\"> 57.242 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Gastroenterostomy </td>\n   <td style=\"text-align:right;\"> 3.286 </td>\n   <td style=\"text-align:right;\"> 0.006 </td>\n   <td style=\"text-align:right;\"> 0.974 </td>\n   <td style=\"text-align:right;\"> 5.598 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Gastroplasty </td>\n   <td style=\"text-align:right;\"> 1.869 </td>\n   <td style=\"text-align:right;\"> 0.679 </td>\n   <td style=\"text-align:right;\"> -7.019 </td>\n   <td style=\"text-align:right;\"> 10.757 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Removal of gastric restrictive device </td>\n   <td style=\"text-align:right;\"> 4.624 </td>\n   <td style=\"text-align:right;\"> 0.395 </td>\n   <td style=\"text-align:right;\"> -6.063 </td>\n   <td style=\"text-align:right;\"> 15.312 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Age </td>\n   <td style=\"text-align:right;\"> -0.157 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> -0.238 </td>\n   <td style=\"text-align:right;\"> -0.076 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Female </td>\n   <td style=\"text-align:right;\"> -1.315 </td>\n   <td style=\"text-align:right;\"> 0.192 </td>\n   <td style=\"text-align:right;\"> -3.293 </td>\n   <td style=\"text-align:right;\"> 0.663 </td>\n  </tr>\n</tbody>\n<tfoot><tr><td style=\"padding: 0; \" colspan=\"100%\">\n<sup></sup> Source: TSHS datasets</td></tr></tfoot>\n</table>\n\n`````\n:::\n:::\n",
    "supporting": [
      "hipoxia_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"hipoxia_files/libs/table1-1.0/table1_defaults.css\" rel=\"stylesheet\" />\r\n<script src=\"hipoxia_files/libs/kePrint-0.0.1/kePrint.js\"></script>\r\n<link href=\"hipoxia_files/libs/lightable-0.0.1/lightable.css\" rel=\"stylesheet\" />\r\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}